{
  "model": "gpt-4",
  "messages": [
    {
      "role": "system",
      "content": "You are an expert test automation engineer specializing in fixing Cypress test failures. Analyze test failures and provide specific selector/locator fixes."
    },
    {
      "role": "user",
      "content": "Analyze the following test failure and provide specific selector/locator fixes.\n\n**INSTRUCTIONS:**\n1. Compare the test expectations with the actual DOM content\n2. Identify why selectors are failing (element not found, text mismatch, etc.)\n3. Provide the exact code changes needed to fix the test\n4. Focus on selector/locator fixes only\n5. Respond in JSON format with analysis and fix fields\n\n**TEST FILE:**\n```javascript\ndescribe('New todo', () => {\n  afterEach(function () {\n    if (this.currentTest.state === 'failed') {\n      const testTitle = this.currentTest.title //.replace(/[<>:\"\\/\\\\|?*]+/g, '-'); // Sanitize filename\n      const errorMessage = this.currentTest.err?.stack || this.currentTest.err?.message || 'Unknown error';\n\n      cy.screenshot(`${testTitle} (failure)`);\n\n      // cy.window({ log: false }).then((win) => {\n      //   const html = win.document.documentElement.outerHTML;\n      //   cy.writeFile(`cypress/failures/${testTitle}.html`, html);\n      //   cy.writeFile(`cypress/failures/${testTitle}.log.txt`, errorMessage);\n      // });\n    }\n  });\n\n  it('should create new todo', () => {\n    cy.visit('/');\n    cy.window().then((win) => {\n     cy.writeFile('cypress/failures/snapshot-before-contains.html', win.document.documentElement.outerHTML);\n    });\n    cy.contains('h1', 'todos');\n\n    cy.get('.new-todo')\n      .type('Demo')\n      .type('{enter}');\n\n    cy.get('.main .todo-list .view').contains('Demo');\n  });\n});\n```\n\n**ACTUAL DOM CONTENT:**\n```html\n<html lang=\"en\"><head> <script type=\"text/javascript\"> (()=>{\"use strict\";const e=window.Cypress=parent.Cypress;if(!e)throw new Error(\"Something went terribly wrong and we cannot proceed. We expected to find the global Cypress in the parent window but it is missing. This should never happen and likely is a bug. Please open an issue.\");const t=(()=>{let e,t,n,r;const i=()=>{e=!1,t=!1,n=[],r={}},o=(e,t=[])=>\"function\"==typeof e?e.apply(window,t):window.eval(e);return i(),{wrap:()=>{const i={setTimeout:window.setTimeout,setInterval:window.setInterval,requestAnimationFrame:window.requestAnimationFrame,clearTimeout:window.clearTimeout,clearInterval:window.clearInterval},a=(e,t)=>i[e].apply(window,t),s=e=>n=>(t&&(r[n]=!0),a(e,[n])),w=t=>(...r)=>{let i,[s,w,...p]=r;return i=a(t,[(...r)=>{if(!e)return o(s,r);n.push({timerId:i,fnOrCode:s,params:r,type:t})},w,...p]),i};window.setTimeout=w(\"setTimeout\"),window.setInterval=w(\"setInterval\"),window.requestAnimationFrame=w(\"requestAnimationFrame\"),window.clearTimeout=s(\"clearTimeout\"),window.clearInterval=s(\"clearInterval\")},reset:i,pause:a=>{e=Boolean(a),e||(t=!0,n.forEach((e=>{const{timerId:t,type:n,fnOrCode:i,params:a}=e;\"setInterval\"===n&&r[t]||o(i,a)})),i())}}})();e.removeAllListeners(\"app:timers:reset\"),e.removeAllListeners(\"app:timers:pause\"),e.on(\"app:timers:reset\",t.reset),e.on(\"app:timers:pause\",t.pause),t.wrap(),e.action(\"app:window:before:load\",window)})(); </script>\n    <meta charset=\"utf-8\">\n    <title>TodoMVC built with React and Redux</title>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n    <meta name=\"description\" content=\"TodoMVC built with React and Redux\">\n  <script defer=\"\" src=\"/static/js/bundle.js\"></script><style>@charset \"utf-8\";\n\nhtml,\nbody {\n\tmargin: 0;\n\tpadding: 0;\n}\n\nbutton {\n\tmargin: 0;\n\tpadding: 0;\n\tborder: 0;\n\tbackground: none;\n\tfont-size: 100%;\n\tvertical-align: baseline;\n\tfont-family: inherit;\n\tfont-weight: inherit;\n\tcolor: inherit;\n\tappearance: none;\n\t-webkit-font-smoot\n```\n\n**WORKFLOW INFO:**\n- Repository: shyamalraju/AI-autoheal-POC-todomvc\n- Workflow: Cypress E2E Tests with Auto-Healing\n- Failure URL: https://github.com/shyamalraju/AI-autoheal-POC-todomvc/actions/runs/16614634954\n\nProvide your analysis and fix in JSON format."
    }
  ],
  "max_tokens": 1000,
  "temperature": 0.1
}
